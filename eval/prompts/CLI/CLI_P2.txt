
STRATEGY: P2 

Few-Shot Examples:

- In the requests library, there is an existing test suite. 
- Use them as examples of test structure and scenario selection. 
- Do not copy these tests verbatim.
- Do not limit test scenarios to only those covered by the example tests.

- Here is the list of the test cases you should be using as examples:
   1. _basic_auth_str
       * test_set_basicauth in requests/tests/test_requests.py
       * test_basic_auth_str_is_always_native in requests/tests/test_requests.py

   2. _parse_content_type_header
       * test__parse_content_type_header in requests/tests/test_utils.py

   3. get_auth_from_url
       * test_get_auth_from_url in requests/tests/test_utils.py

   4. HTTPDigestAuth
       * test_DIGEST_HTTP_200_OK_GET in requests/tests/test_requests.py
       * test_DIGEST_AUTH_RETURNS_COOKIE in requests/tests/test_requests.py
       * test_DIGEST_AUTH_SETS_SESSION_COOKIES in requests/tests/test_requests.py
       * test_DIGEST_STREAM in requests/tests/test_requests.py
       * test_DIGESTAUTH_WRONG_HTTP_401_GET in requests/tests/test_requests.py
       * test_DIGESTAUTH_QUOTES_QOP_VALUE in requests/tests/test_requests.py

   5. prepend_scheme_if_needed
       * test_prepend_scheme_if_needed in requests/tests/test_utils.py

   6. rebuild_auth
       * test_auth_is_stripped_on_http_downgrade in requests/tests/test_requests.py
       * test_auth_is_retained_for_redirect_on_host in requests/tests/test_requests.py

   7. resolve_redirects
       * test_HTTP_302_ALLOW_REDIRECT_GET in requests/tests/test_requests.py
       * test_HTTP_307_ALLOW_REDIRECT_POST in requests/tests/test_requests.py
       * test_HTTP_307_ALLOW_REDIRECT_POST_WITH_SEEKABLE in requests/tests/test_requests.py
       * test_HTTP_302_TOO_MANY_REDIRECTS in requests/tests/test_requests.py
       * test_fragment_maintained_on_redirect in requests/tests/test_requests.py
       * test_HTTP_200_OK_GET_WITH_PARAMS in requests/tests/test_requests.py
       * test_manual_redirect_with_partial_body_read in requests/tests/test_requests.py
       * test_redirect_with_wrong_gzipped_header in requests/tests/test_requests.py

   8. select_proxy
       * test_select_proxies in requests/tests/test_utils.py

   9. should_strip_auth
       * test_should_strip_auth_host_change in requests/tests/test_requests.py
       * test_should_strip_auth_http_downgrade in requests/tests/test_requests.py
       * test_should_strip_auth_https_upgrade in requests/tests/test_requests.py
       * test_should_strip_auth_port_change in requests/tests/test_requests.py
       * test_should_strip_auth_default_port in requests/tests/test_requests.py

   10. unquote_header_value
       * test_valid in requests/tests/test_utils.py
       * test_is_filename in requests/tests/test_utils.py



- BEFORE writing any test code for F, perform and OUTPUT a short static analysis for F:
    -List every conditional branch (if/elif/else) that matters for behavior.
    -List every exception that can be raised or handled (raise, try/except).
    -List every loop condition / termination behavior.
    -For each item, describe one concrete input/state that would trigger it. Keep this analysis concise (bullet points).


Proceed with generating test cases according to the rules in GEMINI.md 